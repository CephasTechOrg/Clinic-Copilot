<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Patient Intake - Clinic Co-Pilot</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@300&display=swap" rel="stylesheet" />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: { 50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe', 300: '#93c5fd', 400: '#60a5fa', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8' },
              accent: { 500: '#8b5cf6', 600: '#7c3aed' },
            },
            fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
            animation: {
              'fade-in': 'fadeIn 0.5s ease-out',
              'slide-up': 'slideUp 0.4s ease-out',
              'pulse-slow': 'pulse 3s infinite',
            },
            keyframes: {
              fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
              slideUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
            }
          }
        }
      }
    </script>
    <style>
      body { font-family: 'Inter', sans-serif; }
      .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
      .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
      .card-hover { transition: all 0.3s ease; }
      .card-hover:hover { transform: translateY(-2px); box-shadow: 0 12px 40px -12px rgba(0,0,0,0.15); }
      input, select, textarea { 
        border-radius: 12px; 
        border: 1.5px solid #e2e8f0; 
        padding: 12px 16px;
        transition: all 0.2s ease;
      }
      input:focus, select:focus, textarea:focus {
        border-color: #3b82f6;
        outline: none;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }
      .progress-bar { transition: width 0.5s ease; }
      input[type="range"] { -webkit-appearance: none; background: transparent; }
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        height: 20px;
        width: 20px;
        border-radius: 50%;
        background: white;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        margin-top: -8px;
      }
      input[type="range"]::-webkit-slider-runnable-track {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: linear-gradient(to right, #22c55e, #eab308, #ef4444);
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-slate-50 via-blue-50/30 to-purple-50/20 text-slate-900 min-h-screen">
    <!-- Decorative Background -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
      <div class="absolute -top-40 -right-40 w-80 h-80 bg-primary-200/30 rounded-full blur-3xl"></div>
      <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-accent-500/20 rounded-full blur-3xl"></div>
    </div>

    <!-- Header -->
    <header class="sticky top-0 z-50 glass border-b border-white/20">
      <div class="max-w-2xl mx-auto px-4 py-3">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 rounded-lg gradient-bg flex items-center justify-center shadow-md">
              <span class="material-symbols-outlined text-white text-lg">medical_services</span>
            </div>
            <h1 class="text-base font-bold bg-gradient-to-r from-primary-600 to-accent-600 bg-clip-text text-transparent">Clinic Co-Pilot</h1>
          </div>
          <div class="flex items-center gap-1.5">
            <span class="text-xs text-slate-400">Step 1/3</span>
            <div class="flex gap-0.5">
              <div class="w-6 h-1 rounded-full bg-primary-500"></div>
              <div class="w-6 h-1 rounded-full bg-slate-200"></div>
              <div class="w-6 h-1 rounded-full bg-slate-200"></div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Progress Bar -->
    <div class="sticky top-[57px] z-40 bg-white/50 backdrop-blur-sm">
      <div class="max-w-2xl mx-auto px-4 py-1.5">
        <div class="flex items-center justify-between text-xs mb-1">
          <span class="font-medium text-slate-600">Progress</span>
          <span class="font-semibold text-primary-600" id="progress-text">0%</span>
        </div>
        <div class="h-1.5 bg-slate-200/50 rounded-full overflow-hidden">
          <div class="h-full bg-gradient-to-r from-primary-500 to-accent-500 rounded-full progress-bar" id="progress-bar" style="width: 0%"></div>
        </div>
      </div>
    </div>

    <main class="relative max-w-2xl mx-auto px-4 py-6 pb-32">
      <form id="intake-form" class="space-y-6">
        <!-- Personal Info Section -->
        <section class="bg-white/70 backdrop-blur-sm rounded-2xl border border-white/50 shadow-xl shadow-slate-200/50 p-6 space-y-5 animate-slide-up card-hover">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-primary-100 flex items-center justify-center">
              <span class="material-symbols-outlined text-primary-600">person</span>
            </div>
            <div>
              <h2 class="font-semibold text-slate-800">Personal Information</h2>
              <p class="text-xs text-slate-500">Basic demographic details</p>
            </div>
          </div>
          
          <div class="grid gap-4 md:grid-cols-2">
            <label class="block">
              <span class="text-sm font-medium text-slate-700 flex items-center gap-1">
                Full Name <span class="text-red-400">*</span>
              </span>
              <input name="full_name" required type="text" placeholder="John Doe" class="mt-2 w-full bg-white/80" />
            </label>
            <label class="block">
              <span class="text-sm font-medium text-slate-700 flex items-center gap-1">
                Age <span class="text-red-400">*</span>
              </span>
              <input name="age" required type="number" min="0" max="130" placeholder="35" class="mt-2 w-full bg-white/80" />
            </label>
            <label class="block">
              <span class="text-sm font-medium text-slate-700 flex items-center gap-1">
                Sex <span class="text-red-400">*</span>
              </span>
              <select name="sex" required class="mt-2 w-full bg-white/80">
                <option value="">Select...</option>
                <option>Female</option>
                <option>Male</option>
                <option>Other</option>
                <option>Prefer not to say</option>
              </select>
            </label>
            <label class="block md:col-span-2">
              <span class="text-sm font-medium text-slate-700 flex items-center gap-1">
                Address <span class="text-red-400">*</span>
              </span>
              <input name="address" required type="text" placeholder="123 Main Street, City" class="mt-2 w-full bg-white/80" />
            </label>
          </div>
        </section>

        <!-- Symptoms Section -->
        <section class="bg-white/70 backdrop-blur-sm rounded-2xl border border-white/50 shadow-xl shadow-slate-200/50 p-6 space-y-5 animate-slide-up card-hover" style="animation-delay: 0.1s">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center">
              <span class="material-symbols-outlined text-amber-600">healing</span>
            </div>
            <div>
              <h2 class="font-semibold text-slate-800">Current Symptoms</h2>
              <p class="text-xs text-slate-500">Describe what you're experiencing</p>
            </div>
          </div>

          <label class="block">
            <span class="text-sm font-medium text-slate-700 flex items-center gap-1">
              Chief Complaint <span class="text-red-400">*</span>
            </span>
            <input name="chief_complaint" required type="text" placeholder="Main reason for your visit" class="mt-2 w-full bg-white/80" />
          </label>
          
          <label class="block">
            <span class="text-sm font-medium text-slate-700 flex items-center gap-1">
              Detailed Symptoms <span class="text-red-400">*</span>
            </span>
            <textarea name="symptoms" required rows="3" placeholder="Please describe your symptoms in detail..." class="mt-2 w-full bg-white/80 resize-none"></textarea>
          </label>
          
          <div class="grid gap-4 md:grid-cols-2">
            <label class="block">
              <span class="text-sm font-medium text-slate-700 flex items-center gap-1">
                Duration <span class="text-red-400">*</span>
              </span>
              <input name="duration" required type="text" placeholder="e.g., 2 days, 1 week" class="mt-2 w-full bg-white/80" />
            </label>
            <div class="block">
              <span class="text-sm font-medium text-slate-700 flex items-center justify-between">
                <span class="flex items-center gap-1">Severity <span class="text-red-400">*</span></span>
                <span class="text-primary-600 font-semibold" id="severity-display">5/10</span>
              </span>
              <div class="mt-3 relative">
                <input name="severity" id="severity" required type="range" min="1" max="10" value="5" class="w-full h-2 rounded-full cursor-pointer" />
                <div class="flex justify-between text-xs text-slate-400 mt-2">
                  <span>Mild</span>
                  <span>Moderate</span>
                  <span>Severe</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Medical History Section -->
        <section class="bg-white/70 backdrop-blur-sm rounded-2xl border border-white/50 shadow-xl shadow-slate-200/50 p-6 space-y-5 animate-slide-up card-hover" style="animation-delay: 0.2s">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center">
              <span class="material-symbols-outlined text-emerald-600">history</span>
            </div>
            <div>
              <h2 class="font-semibold text-slate-800">Medical History</h2>
              <p class="text-xs text-slate-500">Help us understand your background</p>
            </div>
          </div>

          <label class="block">
            <span class="text-sm font-medium text-slate-700">Pre-existing Conditions</span>
            <textarea name="history" rows="2" placeholder="e.g., Diabetes, Hypertension, Asthma..." class="mt-2 w-full bg-white/80 resize-none"></textarea>
          </label>
          
          <label class="block">
            <span class="text-sm font-medium text-slate-700">Current Medications</span>
            <textarea name="medications" rows="2" placeholder="List any medications you're currently taking..." class="mt-2 w-full bg-white/80 resize-none"></textarea>
          </label>
          
          <label class="block">
            <span class="text-sm font-medium text-slate-700 flex items-center gap-2">
              Known Allergies
              <span class="px-2 py-0.5 bg-red-100 text-red-600 text-xs font-semibold rounded-full">Important</span>
            </span>
            <textarea name="allergies" rows="2" placeholder="e.g., Penicillin, Sulfa drugs, Latex..." class="mt-2 w-full bg-white/80 resize-none border-red-200 focus:border-red-400"></textarea>
          </label>
        </section>

        <!-- Privacy Notice -->
        <div class="flex items-start gap-3 p-4 bg-primary-50/50 border border-primary-100 rounded-xl">
          <span class="material-symbols-outlined text-primary-500 text-xl mt-0.5">shield</span>
          <p class="text-sm text-primary-700">Your information is encrypted and shared only with your healthcare team. We follow strict privacy guidelines.</p>
        </div>
      </form>
    </main>

    <!-- Fixed Bottom Action -->
    <div class="fixed bottom-0 left-0 right-0 glass border-t border-white/30 p-4 z-50">
      <div class="max-w-2xl mx-auto">
        <div class="text-center text-sm text-red-500 font-medium hidden" id="intake-error"></div>
        <div class="text-center text-sm text-emerald-600 font-medium hidden" id="intake-success"></div>
        <button id="submit-intake" type="submit" form="intake-form" class="w-full gradient-bg text-white font-semibold py-3.5 rounded-xl shadow-lg shadow-primary-500/30 hover:shadow-xl hover:shadow-primary-500/40 hover:-translate-y-0.5 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
          <span class="material-symbols-outlined">send</span>
          <span>Submit to Healthcare Provider</span>
        </button>
      </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-4 right-4 transform translate-x-[120%] transition-transform duration-300 z-[100]">
      <div class="bg-white rounded-xl shadow-2xl border border-slate-100 p-4 flex items-center gap-3 min-w-[300px]">
        <div class="w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0" id="toast-icon-wrapper">
          <span class="material-symbols-outlined text-emerald-600" id="toast-icon">check_circle</span>
        </div>
        <div>
          <p class="font-semibold text-slate-800" id="toast-title">Success</p>
          <p class="text-sm text-slate-500" id="toast-message">Form submitted successfully</p>
        </div>
      </div>
    </div>

    <script>
      // Toast function (must be defined before patient.js loads)
      window.showToast = function(title, message, isError = false) {
        const toast = document.getElementById('toast');
        const toastTitle = document.getElementById('toast-title');
        const toastMessage = document.getElementById('toast-message');
        const toastIcon = document.getElementById('toast-icon');
        const toastIconWrapper = document.getElementById('toast-icon-wrapper');
        
        toastTitle.textContent = title;
        toastMessage.textContent = message;
        
        if (isError) {
          toastIcon.textContent = 'error';
          toastIconWrapper.className = 'w-10 h-10 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0';
          toastIcon.className = 'material-symbols-outlined text-red-600';
        } else {
          toastIcon.textContent = 'check_circle';
          toastIconWrapper.className = 'w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0';
          toastIcon.className = 'material-symbols-outlined text-emerald-600';
        }
        
        toast.classList.remove('translate-x-[120%]');
        toast.classList.add('translate-x-0');
        
        setTimeout(() => {
          toast.classList.remove('translate-x-0');
          toast.classList.add('translate-x-[120%]');
        }, 4000);
      };
    </script>
    <script src="http://localhost:8000/static/js/patient.js?v=4"></script>
    <script>
      // Severity slider display
      const severitySlider = document.getElementById('severity');
      const severityDisplay = document.getElementById('severity-display');
      if (severitySlider && severityDisplay) {
        severitySlider.addEventListener('input', () => {
          severityDisplay.textContent = severitySlider.value + '/10';
        });
      }

      // Progress bar calculation
      const form = document.getElementById('intake-form');
      const progressBar = document.getElementById('progress-bar');
      const progressText = document.getElementById('progress-text');
      const requiredFields = form.querySelectorAll('[required]');
      
      function updateProgress() {
        let filled = 0;
        requiredFields.forEach(field => {
          if (field.value.trim()) filled++;
        });
        const percentage = Math.round((filled / requiredFields.length) * 100);
        progressBar.style.width = percentage + '%';
        progressText.textContent = percentage + '%';
      }
      
      requiredFields.forEach(field => {
        field.addEventListener('input', updateProgress);
        field.addEventListener('change', updateProgress);
      });
    </script>
  </body>
</html>
